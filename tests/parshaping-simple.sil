\begin[papersize=a7]{document}
\nofolios
\script[src=packages/lorem]
\begin{script}

local testshape = {
  { width = 30, indent = 60 },
  { width = 50, indent = 40 },
  { width = 120, indent = 0 },
  { width = 30, indent = 10 },
  { width = 20, indent = 10 },
  { width = 10, indent = 10 },
}

SILE.settings.set("linebreak.tolerance", 2000)
SILE.settings.set("document.baselineskip", "1.2em")
SILE.settings.set("document.parindent", 0)
SILE.settings.set("linebreak.parShape", true)

SILE.linebreak.parShape = function (self, line)
	if testshape[line] then
		local right = self.hsize - testshape[line].width - testshape[line].indent
		return {
			width = SILE.measurement(testshape[line].width),
			left = testshape[line].indent,
			right = right
		}
	end
	return {
		width = self.hsize,
		left = 0,
		right = 0
	}
end

SILE.call("lorem", { words = 20 })

\end{script}
\end{document}
