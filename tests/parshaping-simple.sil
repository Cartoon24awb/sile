\begin[papersize=a7]{document}
\nofolios
\script[src=packages/lorem]
\begin{script}

local testshape = {
  { 60, 30, nil },
  { 40, 50, nil },
  { 0, 120, nil },
  { 10, 30, nil },
  { 10, nil, 90 },
  { 10, nil, 40 },
}

SILE.settings.set("linebreak.tolerance", 2000)
SILE.settings.set("document.baselineskip", "1.2em")
SILE.settings.set("document.parindent", 0)
SILE.settings.set("linebreak.parShape", true)

SILE.linebreak.parShape = function (self, line)
  local shape = testshape[line]
	if shape then
		return shape[1], shape[2], shape[3]
	else
		return nil, nil, nil
	end
end

SILE.call("lorem", { words = 30 })

\end{script}
\end{document}
